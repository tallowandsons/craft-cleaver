{# @var plugin \tallowandsons\cleaver\Cleaver #}
{# @var settings \tallowandsons\cleaver\models\Settings #}

{% import '_includes/forms.twig' as forms %}
{% from 'cleaver/macros' import configWarning %}

{{ forms.textField({
    label: 'Default Percentage'|t('cleaver'),
    instructions: 'The default percentage of entries to delete when no percentage is specified in the console command.'|t('cleaver'),
    id: 'defaultPercent',
    name: 'defaultPercent',
    value: settings.defaultPercent,
    type: 'number',
    min: 1,
    max: 99,
    required: true,
    errors: settings.getErrors('defaultPercent'),
    warning: (config.defaultPercent is defined ? configWarning('defaultPercent')),
}) }}

{{ forms.textField({
    label: 'Minimum Entries'|t('cleaver'),
    instructions: 'The minimum number of entries to keep per section, regardless of deletion percentage. Set to 0 to allow complete deletion.'|t('cleaver'),
    id: 'minimumEntries',
    name: 'minimumEntries',
    value: settings.minimumEntries,
    type: 'number',
    min: 0,
    required: true,
    errors: settings.getErrors('minimumEntries'),
    warning: (config.minimumEntries is defined ? configWarning('minimumEntries')),
}) }}

{{ forms.textField({
    label: 'Allowed Environments'|t('cleaver'),
    instructions: 'Comma-separated list of environments where Cleaver is allowed to run. Cleaver will be completely blocked in other environments.'|t('cleaver'),
    id: 'allowedEnvironments',
    name: 'allowedEnvironments',
    value: settings.allowedEnvironments|join(','),
    placeholder: 'dev,staging,local',
    required: true,
    errors: settings.getErrors('allowedEnvironments'),
    warning: (config.allowedEnvironments is defined ? configWarning('allowedEnvironments')),
}) }}

{{ forms.textField({
    label: 'Batch Size'|t('cleaver'),
    instructions: 'The number of entries to process in each batch. Larger batches process faster but use more memory.'|t('cleaver'),
    id: 'batchSize',
    name: 'batchSize',
    value: settings.batchSize,
    type: 'number',
    min: 1,
    max: 1000,
    required: true,
    errors: settings.getErrors('batchSize'),
    warning: (config.batchSize is defined ? configWarning('batchSize')),
}) }}

{{ forms.selectField({
    label: 'Default Delete Mode'|t('cleaver'),
    instructions: 'Default behavior when running a chop (can be overridden per run). Choose soft delete (restorable) or hard delete (permanent). '|t('cleaver'),
    id: 'defaultDeleteMode',
    name: 'defaultDeleteMode',
    value: settings.defaultDeleteMode,
    options: [
        { value: 'soft', label: 'Soft Delete (Restorable)'|t('cleaver') },
        { value: 'hard', label: 'Hard Delete (Permanent)'|t('cleaver') }
    ],
    required: true,
    errors: settings.getErrors('defaultDeleteMode'),
    warning: (config.defaultDeleteMode is defined ? configWarning('defaultDeleteMode'))
}) }}
